Index: app/src/main/java/co/kr/todayplay/fragment/perform/PerformWriteReviewFragment2.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package co.kr.todayplay.fragment.perform;\n\nimport android.app.Activity;\nimport android.content.ClipData;\nimport android.content.Intent;\nimport android.database.Cursor;\nimport android.graphics.Bitmap;\nimport android.net.Uri;\nimport android.os.Bundle;\nimport android.provider.MediaStore;\nimport android.text.Editable;\nimport android.text.TextWatcher;\nimport android.util.Log;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.ImageButton;\nimport android.widget.ImageView;\nimport android.widget.RatingBar;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport java.util.ArrayList;\nimport java.util.Objects;\n\nimport androidx.annotation.NonNull;\nimport androidx.annotation.Nullable;\nimport androidx.fragment.app.DialogFragment;\nimport androidx.fragment.app.Fragment;\nimport androidx.loader.content.CursorLoader;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\nimport co.kr.todayplay.MainActivity;\nimport co.kr.todayplay.R;\nimport co.kr.todayplay.adapter.PerformReviewImageAdapter;\nimport co.kr.todayplay.fragment.HomeFragment;\nimport co.kr.todayplay.object.Sim_uri;\n\nimport static android.app.Activity.RESULT_OK;\n\npublic class PerformWriteReviewFragment2 extends Fragment {\n    EditText good_et, bad_et, tip_et;\n    Button photo_btn, save_btn;\n    ImageButton back_btn;\n    RecyclerView photo_rv;\n    ImageView good_more30_iv, bad_more30_iv, photo_icon;\n    TextView good_num_text_tv, bad_num_text_tv, tip_num_text_tv, photo_tv;\n    RatingBar star_rb;\n    ArrayList<Uri> images ;\n\n    DialogFragment writeReviewDialogFragment2 = new WriteReviewDialogFragment2();\n\n    float rate;\n    private static final int DIALOG_REQUEST_CODE = 1234;\n    Bitmap bitmap;\n    int CODE_ALBUM_REQUEST = 111;\n\n    int play_id = -1;\n    int user_id = -1;\n    String certification_type = \"-1\";\n    String certification_imgpath = \"\";\n    String review_certified_pic = \"\";\n    String[] review_pic  = {\"\", \"\", \"\"};\n\n    public PerformWriteReviewFragment2(){}\n\n    @Nullable\n    @Override\n    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\n        ViewGroup viewGroup = (ViewGroup) inflater.inflate(R.layout.fragment_perform_write_review,container,false);\n        Bundle bundle = getArguments();\n        Log.d(\"WriteReview2\", \"onCreateView: \");\n        if(bundle != null){\n//            images = (ArrayList<Sim_uri>)bundle.getSerializable(\"image\");\n//            images = (ArrayList<Sim_uri>)getArguments().get(\"image\");\n            images =bundle.getParcelableArrayList(\"image\");\n            play_id = bundle.getInt(\"play_id\");\n            user_id = bundle.getInt(\"user_id\");\n            certification_type = bundle.getString(\"certification_type\");\n            certification_imgpath = bundle.getString(\"certification_imgpath\");\n            Log.d(\"Bundle result\", \"play_id: \" + play_id + \" | user_id = \" + user_id + \" | certification_type = \" + certification_type + \" certification_imgpath = \" + certification_imgpath);\n            Log.d(\"images Size = \",Integer.toString(images.size()));\n        }\n\n        back_btn = (ImageButton) viewGroup.findViewById(R.id.back_btn);\n        back_btn.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n                showDialog(writeReviewDialogFragment2);\n            }\n        });\n\n        star_rb = (RatingBar)viewGroup.findViewById(R.id.star_rb);\n        star_rb.setOnRatingBarChangeListener(new RatingBar.OnRatingBarChangeListener() {\n            @Override\n            public void onRatingChanged(RatingBar ratingBar, float v, boolean b) {\n                rate = ratingBar.getRating();\n                Log.d(\"star\", \"onRatingChanged: rate = \" + rate);\n                if(rate > 0){\n                    if(good_et.getText().toString().length() >= 30 && bad_et.getText().toString().length() >= 30){\n                        save_btn.setEnabled(true);\n                        save_btn.setBackgroundResource(R.drawable.rounded_border_4dp_ffe34e);\n                    }\n                    else{\n                        save_btn.setEnabled(false);\n                        save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                    }\n                }\n                else{\n                    save_btn.setEnabled(false);\n                    save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                }\n            }\n        });\n\n        save_btn = (Button)viewGroup.findViewById(R.id.save_btn);\n        save_btn.setEnabled(false);\n        save_btn.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n\n                PerformRecommendDialogFragment performRecommendDialogFragment = new PerformRecommendDialogFragment();\n                Bundle bundle1 = new Bundle();\n                bundle1.putInt(\"play_id\", play_id);\n                bundle1.putInt(\"user_id\", user_id);\n                bundle1.putString(\"review_good\", good_et.getText().toString());\n                bundle1.putString(\"review_bad\", bad_et.getText().toString());\n                bundle1.putString(\"review_tip\", tip_et.getText().toString());\n                //수정\n                bundle1.putString(\"review_pic1\", review_pic[0]);\n                bundle1.putString(\"review_pic2\", review_pic[1]);\n                bundle1.putString(\"review_pic3\", review_pic[2]);\n                Log.d(\"WriteReview2\", \"review_pic1 = \" + review_pic[0] + \" review_pic2 = \" + review_pic[1] + \"review_pic3 = \" + review_pic[2]);\n                bundle1.putString(\"certification_type\", certification_type);\n                bundle1.putString(\"certification_imgpath\", certification_imgpath);\n                bundle1.putInt(\"num_of_star\", (int)rate);\n                bundle1.putParcelableArrayList(\"images\",images);\n                performRecommendDialogFragment.setArguments(bundle1);\n                performRecommendDialogFragment.setCancelable(false);\n                performRecommendDialogFragment.show(getActivity().getSupportFragmentManager(),\"PerformWriteReviewFragment\");\n                Log.d(\"images_size\",Integer.toString(images.size()));\n            }\n        });\n\n        good_et = (EditText)viewGroup.findViewById(R.id.good_et);\n        good_more30_iv = (ImageView)viewGroup.findViewById(R.id.good_more30_iv);\n        good_num_text_tv = (TextView)viewGroup.findViewById(R.id.good_num_text_tv);\n        good_et.addTextChangedListener(new TextWatcher() {\n            @Override\n            public void beforeTextChanged(CharSequence charSequence, int start, int count, int after) {\n\n            }\n\n            @Override\n            public void onTextChanged(CharSequence charSequence, int start, int count, int after) {\n                good_num_text_tv.setText(good_et.getText().toString().length() + \"/1000\");\n                if(good_et.getText().toString().length() >= 30){\n                    good_more30_iv.setImageResource(R.drawable.write_review_more30_yellow);\n                    if(bad_et.getText().toString().length() >= 30){\n                        if(rate > 0){\n                            save_btn.setEnabled(true);\n                            save_btn.setBackgroundResource(R.drawable.rounded_border_4dp_ffe34e);\n                        }\n                        else{\n                            save_btn.setEnabled(false);\n                            save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                        }\n                    }\n                    else{\n                        save_btn.setEnabled(false);\n                        save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                    }\n                }\n                else{\n                    save_btn.setEnabled(false);\n                    save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                    good_more30_iv.setImageResource(R.drawable.write_review_more30_gray);\n                }\n            }\n\n            @Override\n            public void afterTextChanged(Editable editable) {\n\n            }\n        });\n\n        bad_et = (EditText)viewGroup.findViewById(R.id.bad_et);\n        bad_num_text_tv = (TextView)viewGroup.findViewById(R.id.bad_num_text_tv);\n        bad_more30_iv = (ImageView)viewGroup.findViewById(R.id.bad_more30_iv);\n        bad_et.addTextChangedListener(new TextWatcher() {\n            @Override\n            public void beforeTextChanged(CharSequence charSequence, int start, int count, int after) {\n\n            }\n\n            @Override\n            public void onTextChanged(CharSequence charSequence, int start, int count, int after) {\n                bad_num_text_tv.setText(bad_et.getText().toString().length() + \"/1000\");\n                if(bad_et.getText().toString().length() >= 30){\n                    bad_more30_iv.setImageResource(R.drawable.write_review_more30_yellow);\n                    if(good_et.getText().toString().length() >= 30){\n                        if(rate > 0){\n                            save_btn.setEnabled(true);\n                            save_btn.setBackgroundResource(R.drawable.rounded_border_4dp_ffe34e);\n                        }\n                        else{\n                            save_btn.setEnabled(false);\n                            save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                        }\n                    }\n                    else{\n                        save_btn.setEnabled(false);\n                        save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                    }\n                }\n                else{\n                    save_btn.setEnabled(false);\n                    save_btn.setBackgroundResource(R.drawable.round_border_4dp_fefefe);\n                    bad_more30_iv.setImageResource(R.drawable.write_review_more30_gray);\n                }\n            }\n\n            @Override\n            public void afterTextChanged(Editable editable) {\n\n            }\n        });\n\n        tip_et = (EditText)viewGroup.findViewById(R.id.tip_et);\n        tip_num_text_tv = (TextView)viewGroup.findViewById(R.id.tip_num_text_tv);\n        tip_et.addTextChangedListener(new TextWatcher() {\n            @Override\n            public void beforeTextChanged(CharSequence charSequence, int start, int count, int after) {\n\n            }\n\n            @Override\n            public void onTextChanged(CharSequence charSequence, int start, int count, int after) {\n                tip_num_text_tv.setText(tip_et.getText().toString().length() + \"/1000\");\n            }\n\n            @Override\n            public void afterTextChanged(Editable editable) {\n\n            }\n        });\n\n        photo_btn = (Button)viewGroup.findViewById(R.id.photo_btn);\n        photo_rv = (RecyclerView)viewGroup.findViewById(R.id.photo_rv);\n        photo_btn.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                /*\n                Intent intent = new Intent(Intent.ACTION_PICK);\n                intent.setDataAndType(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,\"image/*\");\n                intent.putExtra(intent.EXTRA_ALLOW_MULTIPLE, true);\n                startActivityForResult(Intent.createChooser(intent, \"사진 애플리케이션을 선택해주세요.\"), CODE_ALBUM_REQUEST);\n            */\n\n\n                Intent intent = new Intent(Intent.ACTION_PICK);\n                intent.setType(\"image/*\");\n                intent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true);\n                intent.setAction(Intent.ACTION_GET_CONTENT);\n                startActivityForResult(Intent.createChooser(intent, \"사진 애플리케이션을 선택해주세요.\"), CODE_ALBUM_REQUEST);\n\n\n            }\n        });\n\n\n        return viewGroup;\n    }\n\n    @Override\n    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\n        super.onActivityResult(requestCode, resultCode, data);\n        Log.d(\"WriteReviewFragment2\", \"onActivityResult: \");\n        //갤러리 이미지 가져오기\n        if(requestCode == CODE_ALBUM_REQUEST && resultCode == RESULT_OK && data != null && data.getClipData() != null){\n            ArrayList<Uri> uriList = new ArrayList<>();\n            //review_pic 초기화\n            for(int i=0; i<review_pic.length; i++){\n                review_pic[i] = \"\";\n            }\n            // 리사이클러뷰 초기화\n            final PerformReviewImageAdapter performReviewImageAdapter = new PerformReviewImageAdapter(uriList, getContext());\n            photo_rv.setAdapter(performReviewImageAdapter);\n            photo_rv.setLayoutManager(new LinearLayoutManager(getActivity().getApplicationContext(),LinearLayoutManager.HORIZONTAL,false));\n            //Log.d(\"get_data\",data.getData().toString());\n            Log.d(\"data_ClipData\",data.getClipData().toString());\n            if(data.getClipData() != null){\n                ClipData clipData = data.getClipData();\n                Log.d(\"WriteReviewFragment2\", \"picked photo num = \" + clipData.getItemCount());\n                if(clipData.getItemCount() > 3){\n                    Toast.makeText(getActivity().getApplicationContext(), \"사진은 최대 3개까지 선택 가능 합니다.\", Toast.LENGTH_SHORT).show();\n                    for(int i =1;i<images.size();i++){\n                        images.remove(i);\n                    }\n                    Log.d(\"images_Size\",Integer.toString(images.size()));\n                    uriList.clear();\n                    return;\n                }else if(clipData.getItemCount() == 1){\n                    Uri filePath = clipData.getItemAt(0).getUri();\n                    data.getData();\n                    review_pic[0] = getRealPathFromUri(filePath);\n                    Log.d(\"WriteReviewFragment2\", \"Uri = \" + clipData.getItemAt(0).getUri());\n                    images.add(filePath);\n                    Log.d(\"images_confirm\",images.get(1).toString());\n                    uriList.add(filePath);\n                }else if(clipData.getItemCount() > 1 && clipData.getItemCount() <= 3){\n                    for(int i=0; i<clipData.getItemCount(); i++){\n                        images.add(clipData.getItemAt(i).getUri());\n                        uriList.add(clipData.getItemAt(i).getUri());\n                        review_pic[i] = getRealPathFromUri(clipData.getItemAt(i).getUri());\n                        Log.d(\"WriteReviewFragment2\", \"Uri \" + i + \" = \" + clipData.getItemAt(i).getUri());\n                        Log.d(\"images_confirm\",images.get(i).toString());\n                    }\n                }\n                performReviewImageAdapter.notifyDataSetChanged();\n            }\n            else if(data.getData() != null){\n                review_pic[0] = data.getData().toString();\n                Log.d(\"WriteReviewFragment2\", \"Uri = \" + data.getData());\n                images.add(data.getData());\n                uriList.add(data.getData());\n                performReviewImageAdapter.notifyDataSetChanged();\n            }\n\n        }\n    }\n\n    //Uri를 절대경로로 바꿔서 리턴해주는 함수\n    String getRealPathFromUri(Uri contentUri) {\n        String[] proj = { MediaStore.Images.Media.DATA };\n        CursorLoader loader = new CursorLoader(getActivity().getApplicationContext(), contentUri, proj, null, null, null);\n        Cursor cursor = loader.loadInBackground();\n        int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);\n        cursor.moveToFirst();\n        String result = cursor.getString(column_index);\n        cursor.close();\n        return result;\n    }\n\n    void showDialog(DialogFragment dialogFragment){\n        dialogFragment.setCancelable(false);\n        dialogFragment.show(getParentFragmentManager(),\"writeReviewDialogFragment\");\n    }\n\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/co/kr/todayplay/fragment/perform/PerformWriteReviewFragment2.java	(revision 155e181bc449249ff257f8b63607b8ebe47ea51a)
+++ app/src/main/java/co/kr/todayplay/fragment/perform/PerformWriteReviewFragment2.java	(date 1621065482000)
@@ -49,6 +49,8 @@
     TextView good_num_text_tv, bad_num_text_tv, tip_num_text_tv, photo_tv;
     RatingBar star_rb;
     ArrayList<Uri> images ;
+    ArrayList<Uri> uriList = new ArrayList<>();
+    PerformReviewImageAdapter performReviewImageAdapter;
 
     DialogFragment writeReviewDialogFragment2 = new WriteReviewDialogFragment2();
 
@@ -247,6 +249,10 @@
             }
         });
 
+        performReviewImageAdapter = new PerformReviewImageAdapter(uriList, getContext());
+        photo_rv.setAdapter(performReviewImageAdapter);
+        photo_rv.setLayoutManager(new LinearLayoutManager(getActivity().getApplicationContext(),LinearLayoutManager.HORIZONTAL,false));
+
         photo_btn = (Button)viewGroup.findViewById(R.id.photo_btn);
         photo_rv = (RecyclerView)viewGroup.findViewById(R.id.photo_rv);
         photo_btn.setOnClickListener(new View.OnClickListener() {
@@ -278,20 +284,19 @@
     public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
         super.onActivityResult(requestCode, resultCode, data);
         Log.d("WriteReviewFragment2", "onActivityResult: ");
-        //갤러리 이미지 가져오기
-        if(requestCode == CODE_ALBUM_REQUEST && resultCode == RESULT_OK && data != null && data.getClipData() != null){
-            ArrayList<Uri> uriList = new ArrayList<>();
-            //review_pic 초기화
-            for(int i=0; i<review_pic.length; i++){
-                review_pic[i] = "";
-            }
+
+        //review_pic, uriList 초기화
+        uriList.clear();
+        for(int i=0; i<review_pic.length; i++){
+            review_pic[i] = "";
+        }
+
+        //갤러리 이미지 가져오기
+        if(requestCode == CODE_ALBUM_REQUEST && resultCode == RESULT_OK && data != null){
             // 리사이클러뷰 초기화
-            final PerformReviewImageAdapter performReviewImageAdapter = new PerformReviewImageAdapter(uriList, getContext());
-            photo_rv.setAdapter(performReviewImageAdapter);
-            photo_rv.setLayoutManager(new LinearLayoutManager(getActivity().getApplicationContext(),LinearLayoutManager.HORIZONTAL,false));
             //Log.d("get_data",data.getData().toString());
-            Log.d("data_ClipData",data.getClipData().toString());
             if(data.getClipData() != null){
+                Log.d("data_ClipData",data.getClipData().toString());
                 ClipData clipData = data.getClipData();
                 Log.d("WriteReviewFragment2", "picked photo num = " + clipData.getItemCount());
                 if(clipData.getItemCount() > 3){
